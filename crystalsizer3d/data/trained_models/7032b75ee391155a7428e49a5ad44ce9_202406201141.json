{
    "created": "202406201141",
    "id": "7032b75ee391155a7428e49a5ad44ce9",
    "dataset_args": {
        "dataset_path": "/home/tom0/projects/crystalsizer3d/data/datasets/20240619_alpha_a.1_seeds_100k",
        "check_image_paths": false,
        "train_test_split": 0.8,
        "use_clean_images": false,
        "augment": true,
        "train_zingg": false,
        "train_distances": true,
        "train_transformation": true,
        "train_3d": true,
        "train_material": true,
        "train_light": true,
        "train_predictor": true,
        "train_generator": false,
        "train_combined": false,
        "rotation_mode": "axisangle",
        "use_distance_switches": false,
        "add_coord_grid": false,
        "check_symmetries": 0,
        "use_canonical_rotations": false,
        "hash": "c41f617ac5933f97bd3dfcf6af6cf5b3"
    },
    "network_args": {
        "base_net": "timm",
        "hyperparameters": {
            "model_name": "regnety_160.sw_in12k_ft_in1k",
            "dropout_prob": 0.0,
            "droppath_prob": 0.0,
            "classifier_hidden_layers": [],
            "classifier_dropout_prob": 0.0
        },
        "hash": "b40d1fb8728a36f82c83cbdc46dad64a"
    },
    "generator_args": {
        "gen_input_noise_std": 0.0,
        "gen_model_name": "dcgan",
        "gen_latent_size": 100,
        "gen_image_loss": "l2",
        "dcgan_n_blocks": 4,
        "dcgan_n_base_filters": 64,
        "ggan_oversample": false,
        "ggan_dim_capacity": 16,
        "ggan_dim_max": 512,
        "ggan_self_attn_resolutions": [
            32,
            16
        ],
        "ggan_self_attn_dim_head": 32,
        "ggan_self_attn_heads": 4,
        "ggan_self_attn_ff_mult": 4,
        "ggan_cross_attn_resolutions": [
            32,
            16
        ],
        "ggan_cross_attn_dim_head": 32,
        "ggan_cross_attn_heads": 4,
        "ggan_cross_attn_ff_mult": 4,
        "vitvae_oversample": false,
        "vitvae_n_layers": 3,
        "vitvae_patch_size": 16,
        "vitvae_dim_head": 32,
        "vitvae_heads": 4,
        "vitvae_ff_mult": 4,
        "use_discriminator": false,
        "disc_n_base_filters": 32,
        "disc_n_layers": 4,
        "hash": "73419849e3edfb1408f7f0beff9ef369"
    },
    "transcoder_args": {
        "use_transcoder": false,
        "tc_latent_size": 128,
        "tc_latent_activation": "none",
        "tc_trained_by": "self",
        "tc_model_name": "mask_inv",
        "tc_vae_layers": [],
        "tc_normalise_latents": true,
        "tc_ae_variant": "variational",
        "tc_dim_enc": 256,
        "tc_dim_dec": 256,
        "tc_num_heads": 16,
        "tc_dim_feedforward": 1024,
        "tc_num_layers": 5,
        "tc_depth_enc": 6,
        "tc_depth_dec": 5,
        "tc_dropout_prob": 0.0,
        "tc_activation": "gelu",
        "tc_min_w_kl": 0.001,
        "tc_max_w_kl": 0.1,
        "tc_rec_threshold": 0.1,
        "tc_w_l1": 0.0,
        "tc_w_l2": 0.0,
        "tc_w_indep": 0.0,
        "hash": "a5e1fb551e4d7db3fce09654e2e9afa7"
    },
    "optimiser_args": {
        "algorithm": "adamw",
        "lr_init": 0.0001,
        "lr_pretrained_init": 0.0001,
        "lr_generator_init": 0.1,
        "lr_discriminator_init": 0.1,
        "lr_transcoder_init": 0.1,
        "lr_scheduler": "cosine",
        "lr_min": 1e-06,
        "lr_warmup": 1e-05,
        "lr_warmup_epochs": 2,
        "lr_decay_epochs": 15,
        "lr_decay_milestones": [],
        "lr_cooldown_epochs": 0,
        "lr_patience_epochs": 10,
        "lr_decay_rate": 0.1,
        "lr_cycle_mul": 1.0,
        "lr_cycle_decay": 0.1,
        "lr_cycle_limit": 1,
        "lr_k_decay": 1.0,
        "weight_decay": 0.001,
        "clip_grad_norm": 0.1,
        "freeze_pretrained": false,
        "gan_loss": "hinge",
        "disc_loss_threshold": 0.1,
        "teach_threshold_pred": 100000000.0,
        "teach_threshold_gen": 100000000.0,
        "teach_threshold_combined": true,
        "w_zingg": 1.0,
        "w_distances": 1.0,
        "w_transformation": 0.0,
        "w_3d": 1.0,
        "w_3d_overshoot": 0.0,
        "w_3d_undershoot": 0.0,
        "w_material": 0.1,
        "w_light": 0.1,
        "w_generator": 1.0,
        "w_net_teacher": 1.0,
        "w_gen_teacher": 1.0,
        "w_discriminator": 1.0,
        "w_transcoder_pred": 1.0,
        "w_transcoder_gen": 1.0,
        "w_com_X": 0.0,
        "w_com_Y": 0.0,
        "hash": "ef22a8febe736e835f0b339cbfa7c813"
    },
    "runtime_args": {
        "resume": true,
        "resume_from": "latest",
        "resume_only": false,
        "seed": null,
        "use_gpu": true,
        "n_dataloader_workers": 4,
        "prefetch_factor": 8,
        "batch_size": 64,
        "n_epochs": 200,
        "checkpoint_every_n_epochs": 5,
        "checkpoint_every_n_batches": -1,
        "max_checkpoints": 5,
        "test_every_n_epochs": 1,
        "log_every_n_batches": 200,
        "plot_every_n_batches": 200,
        "plot_n_examples": 4,
        "save_plots": true,
        "save_plots_to_tb": true,
        "track_metrics": [],
        "hash": "2ce333bcd9b1198d5fb17f6517386d25"
    },
    "old_args": {},
    "epoch": 33,
    "step": 41250,
    "examples_count": 2640000,
    "loss_train": 0.077797863727808,
    "loss_test": 0.15838699233837616,
    "metrics_train": {
        "losses/distances": 16.283671224489808,
        "losses/transformation": 1342.5486230254173,
        "losses/3d": 65.23518265411258,
        "losses/material": 104.86472147330642,
        "losses/light": 52.42003414593637
    },
    "metrics_test": {
        "losses/distances": 0.035552339091037326,
        "losses/transformation": 1.1535067514349253,
        "losses/3d": 0.07466882155635036,
        "losses/material": 0.4184903454226561,
        "losses/light": 0.06316795943973538
    },
    "snapshots": {
        "12500": {
            "epoch": 10,
            "step": 12500,
            "examples_count": 800000,
            "loss_train": 0.14440714763998985,
            "loss_test": 0.19881227856072095,
            "metrics_train": {
                "losses/distances": 36.881138153374195,
                "losses/transformation": 1393.145391345024,
                "losses/3d": 102.80436950922012,
                "losses/material": 302.88061048835516,
                "losses/light": 105.35364870354533
            },
            "metrics_test": {
                "losses/distances": 0.0445964422244101,
                "losses/transformation": 1.037747904085196,
                "losses/3d": 0.09023542083704318,
                "losses/material": 0.5515396546285886,
                "losses/light": 0.08826448997625938
            },
            "created": "20240620181737",
            "state_path": "7032b75ee391155a7428e49a5ad44ce9/snapshots/000012500_20240620181737.pth"
        },
        "18750": {
            "epoch": 15,
            "step": 18750,
            "examples_count": 1200000,
            "loss_train": 0.11666682434082032,
            "loss_test": 0.1911282941030386,
            "metrics_train": {
                "losses/distances": 27.394660007208586,
                "losses/transformation": 1457.044672548771,
                "losses/3d": 88.43533740565181,
                "losses/material": 210.91118872910738,
                "losses/light": 89.12413389235735
            },
            "metrics_test": {
                "losses/distances": 0.03921746675116129,
                "losses/transformation": 1.1555264874910698,
                "losses/3d": 0.08742825990208448,
                "losses/material": 0.5685902062134865,
                "losses/light": 0.07623545390864213
            },
            "created": "20240620213859",
            "state_path": "7032b75ee391155a7428e49a5ad44ce9/snapshots/000018750_20240620213859.pth"
        },
        "25000": {
            "epoch": 20,
            "step": 25000,
            "examples_count": 1600000,
            "loss_train": 0.10200805446505547,
            "loss_test": 0.16722949393666708,
            "metrics_train": {
                "losses/distances": 22.85609347652644,
                "losses/transformation": 1388.3639324903488,
                "losses/3d": 80.1344371587038,
                "losses/material": 168.01864003390074,
                "losses/light": 77.17672984302044
            },
            "metrics_test": {
                "losses/distances": 0.03816153929353906,
                "losses/transformation": 1.0973749957405603,
                "losses/3d": 0.0780970494573315,
                "losses/material": 0.4370814883747162,
                "losses/light": 0.07262755697593093
            },
            "created": "20240621010215",
            "state_path": "7032b75ee391155a7428e49a5ad44ce9/snapshots/000025000_20240621010215.pth"
        },
        "31250": {
            "epoch": 25,
            "step": 31250,
            "examples_count": 2000000,
            "loss_train": 0.09115362156629563,
            "loss_test": 0.16484818149071473,
            "metrics_train": {
                "losses/distances": 19.634111531078815,
                "losses/transformation": 1344.268777668476,
                "losses/3d": 73.92277047410607,
                "losses/material": 137.47762170433998,
                "losses/light": 66.37382531911135
            },
            "metrics_test": {
                "losses/distances": 0.03643819851538119,
                "losses/transformation": 1.0659369830137644,
                "losses/3d": 0.07712968734976573,
                "losses/material": 0.4488887997965018,
                "losses/light": 0.06391414777877238
            },
            "created": "20240621044317",
            "state_path": "7032b75ee391155a7428e49a5ad44ce9/snapshots/000031250_20240621044317.pth"
        },
        "37500": {
            "epoch": 30,
            "step": 37500,
            "examples_count": 2400000,
            "loss_train": 0.08335375840067863,
            "loss_test": 0.16043759767825788,
            "metrics_train": {
                "losses/distances": 17.510441364720464,
                "losses/transformation": 1335.2002802491188,
                "losses/3d": 69.42577729001641,
                "losses/material": 114.80544966459274,
                "losses/light": 57.75434350036085
            },
            "metrics_test": {
                "losses/distances": 0.035589090620095916,
                "losses/transformation": 1.1876401861126606,
                "losses/3d": 0.07697323777784522,
                "losses/material": 0.41592740716460425,
                "losses/light": 0.06282527779396145
            },
            "created": "20240621080313",
            "state_path": "7032b75ee391155a7428e49a5ad44ce9/snapshots/000037500_20240621080313.pth"
        },
        "93750": {
            "epoch": 75,
            "step": 93750,
            "examples_count": 6000000,
            "loss_train": 0.041783489593863486,
            "loss_test": 0.1430594390258193,
            "metrics_train": {
                "losses/distances": 7.459785324521363,
                "losses/transformation": 1364.5735560059547,
                "losses/3d": 39.239701732993126,
                "losses/material": 34.89891282096505,
                "losses/light": 20.399837114848197
            },
            "metrics_test": {
                "losses/distances": 0.031200538067003854,
                "losses/transformation": 1.1077215866400645,
                "losses/3d": 0.0671053416788196,
                "losses/material": 0.394803811246768,
                "losses/light": 0.052731762843158766
            },
            "created": "20240622112218",
            "state_path": "7032b75ee391155a7428e49a5ad44ce9/snapshots/000093750_20240622112218.pth"
        }
    }
}
