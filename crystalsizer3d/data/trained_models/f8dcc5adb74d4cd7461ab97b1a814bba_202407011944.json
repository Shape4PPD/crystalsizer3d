{
    "created": "202407011944",
    "id": "f8dcc5adb74d4cd7461ab97b1a814bba",
    "dataset_args": {
        "dataset_path": "/home/tom0/projects/crystalsizer3d/data/datasets/20240621_alpha_asc_100k",
        "check_image_paths": false,
        "train_test_split": 0.8,
        "use_clean_images": false,
        "augment": true,
        "augment_blur_prob": 0.3,
        "augment_blur_min_sigma": 0.01,
        "augment_blur_max_sigma": 5.0,
        "augment_noise_prob": 0.3,
        "augment_noise_min_sigma": 0.01,
        "augment_noise_max_sigma": 0.1,
        "train_zingg": false,
        "train_distances": true,
        "train_transformation": true,
        "train_3d": false,
        "train_material": true,
        "train_light": true,
        "train_predictor": false,
        "train_generator": false,
        "train_combined": false,
        "train_denoiser": true,
        "rotation_mode": "axisangle",
        "use_distance_switches": false,
        "add_coord_grid": false,
        "check_symmetries": 0,
        "use_canonical_rotations": false,
        "hash": "fafff3b256f8e6fd2544fbdd72be81f5"
    },
    "network_args": {
        "base_net": "timm",
        "hyperparameters": {
            "model_name": "regnetx_008.tv2_in1k",
            "dropout_prob": 0.0,
            "droppath_prob": 0.0,
            "classifier_hidden_layers": [],
            "classifier_dropout_prob": 0.0
        },
        "hash": "e92f0d522abca1105e406fad8f1cb44d"
    },
    "generator_args": {
        "gen_input_noise_std": 0.0,
        "gen_model_name": "dcgan",
        "gen_latent_size": 100,
        "gen_image_loss": "l2",
        "gen_include_face_areas": false,
        "dcgan_n_blocks": 4,
        "dcgan_n_base_filters": 64,
        "ggan_oversample": false,
        "ggan_dim_capacity": 16,
        "ggan_dim_max": 512,
        "ggan_self_attn_resolutions": [
            32,
            16
        ],
        "ggan_self_attn_dim_head": 32,
        "ggan_self_attn_heads": 4,
        "ggan_self_attn_ff_mult": 4,
        "ggan_cross_attn_resolutions": [
            32,
            16
        ],
        "ggan_cross_attn_dim_head": 32,
        "ggan_cross_attn_heads": 4,
        "ggan_cross_attn_ff_mult": 4,
        "vitvae_oversample": false,
        "vitvae_n_layers": 3,
        "vitvae_patch_size": 16,
        "vitvae_dim_head": 32,
        "vitvae_heads": 4,
        "vitvae_ff_mult": 4,
        "use_discriminator": false,
        "disc_n_base_filters": 32,
        "disc_n_layers": 4,
        "use_rcf": false,
        "rcf_model_path": "/home/tom0/projects/crystalsizer3d/data/bsds500_pascal_model.pth",
        "rcf_loss_type": "l2",
        "hash": "ee0e9f94fa7032c862cd412d2ed686ff"
    },
    "denoiser_args": {
        "dn_model_name": "MAGVIT2",
        "dn_mv2_config_path": "/home/tom0/projects/crystalsizer3d/data/MAGVIT2/imagenet_lfqgan_256_B.yaml",
        "dn_mv2_checkpoint_path": "/home/tom0/projects/crystalsizer3d/data/MAGVIT2/imagenet_256_B.ckpt",
        "hash": "e8d0c6231acd4008fb9c72898a191a46"
    },
    "transcoder_args": {
        "use_transcoder": false,
        "tc_latent_size": 128,
        "tc_latent_activation": "none",
        "tc_trained_by": "self",
        "tc_model_name": "mask_inv",
        "tc_vae_layers": [],
        "tc_normalise_latents": true,
        "tc_ae_variant": "variational",
        "tc_dim_enc": 256,
        "tc_dim_dec": 256,
        "tc_num_heads": 16,
        "tc_dim_feedforward": 1024,
        "tc_num_layers": 5,
        "tc_depth_enc": 6,
        "tc_depth_dec": 5,
        "tc_dropout_prob": 0.0,
        "tc_activation": "gelu",
        "tc_min_w_kl": 0.001,
        "tc_max_w_kl": 0.1,
        "tc_rec_threshold": 0.1,
        "tc_w_l1": 0.0,
        "tc_w_l2": 0.0,
        "tc_w_indep": 0.0,
        "hash": "a5e1fb551e4d7db3fce09654e2e9afa7"
    },
    "optimiser_args": {
        "algorithm": "adamw",
        "lr_init": 0.0001,
        "lr_pretrained_init": 0.0001,
        "lr_generator_init": 0.0001,
        "lr_discriminator_init": 0.1,
        "lr_denoiser_init": 1e-05,
        "lr_transcoder_init": 0.1,
        "lr_scheduler": "cosine",
        "lr_min": 1e-06,
        "lr_warmup": 1e-06,
        "lr_warmup_epochs": 2,
        "lr_decay_epochs": 10,
        "lr_decay_milestones": [],
        "lr_cooldown_epochs": 0,
        "lr_patience_epochs": 10,
        "lr_decay_rate": 0.1,
        "lr_cycle_mul": 1.0,
        "lr_cycle_decay": 0.1,
        "lr_cycle_limit": 1,
        "lr_k_decay": 1.0,
        "accumulate_grad_batches": 1,
        "weight_decay": 0.001,
        "clip_grad_norm": 1.0,
        "freeze_pretrained": false,
        "gan_loss": "hinge",
        "disc_loss_threshold": 0.1,
        "teach_threshold_pred": 100000000.0,
        "teach_threshold_gen": 0.008,
        "teach_threshold_combined": false,
        "w_zingg": 1.0,
        "w_distances": 1.0,
        "w_transformation": 0.0,
        "w_3d": 1.0,
        "w_3d_overshoot": 0.0,
        "w_3d_undershoot": 0.0,
        "w_material": 0.1,
        "w_light": 0.1,
        "w_generator": 10.0,
        "w_net_teacher": 10.0,
        "w_gen_teacher": 0.0,
        "w_discriminator": 1.0,
        "w_rcf": 0.0,
        "w_transcoder_pred": 1.0,
        "w_transcoder_gen": 1.0,
        "w_com_X": 0.0,
        "w_com_Y": 0.0,
        "hash": "fb5794031f6917db5604012b5ae1c752"
    },
    "runtime_args": {
        "resume": true,
        "resume_from": "/jmain02/home/J2AD014/mtc10/txi53-mtc10/projects/crystalsizer3d/logs/scripts/train_synthetic/ds=20240621_alpha_asc_100k/a749f44ee3b7f1912f4e8c43eea6142d_202407011944.json",
        "resume_only": true,
        "seed": null,
        "use_gpu": true,
        "n_dataloader_workers": 4,
        "prefetch_factor": 8,
        "batch_size": 8,
        "steps_per_batch": 1,
        "n_epochs": 200,
        "checkpoint_every_n_epochs": 1,
        "checkpoint_every_n_batches": -1,
        "max_checkpoints": 5,
        "test_every_n_epochs": 1,
        "log_every_n_batches": 200,
        "plot_every_n_batches": 200,
        "plot_n_examples": 4,
        "save_plots": true,
        "save_plots_to_tb": true,
        "track_metrics": [],
        "hash": "1c7841267ad7cfdb0a7b993ebfddc3e8"
    },
    "old_args": {},
    "epoch": 26,
    "step": 260000,
    "examples_count": 2080000,
    "loss_train": -0.7103038660466671,
    "loss_test": 0.03389262084439397,
    "metrics_train": {
        "losses/distances": 0.0,
        "losses/transformation": 0.0,
        "losses/material": 0.0,
        "losses/light": 0.0,
        "losses/denoiser": -7103.038660466671
    },
    "metrics_test": {
        "losses/distances": 0.0,
        "losses/transformation": 0.0,
        "losses/material": 0.0,
        "losses/light": 0.0,
        "losses/denoiser": 0.03389262084439397
    },
    "snapshots": {
        "220000": {
            "epoch": 22,
            "step": 220000,
            "examples_count": 1760000,
            "loss_train": -0.7086381453037262,
            "loss_test": 0.03631750679835677,
            "metrics_train": {
                "losses/distances": 0.0,
                "losses/transformation": 0.0,
                "losses/material": 0.0,
                "losses/light": 0.0,
                "losses/denoiser": -7086.381453037262
            },
            "metrics_test": {
                "losses/distances": 0.0,
                "losses/transformation": 0.0,
                "losses/material": 0.0,
                "losses/light": 0.0,
                "losses/denoiser": 0.03631750679835677
            },
            "created": "20240705195432",
            "state_path": "f8dcc5adb74d4cd7461ab97b1a814bba/snapshots/000220000_20240705195432.pth"
        },
        "230000": {
            "epoch": 23,
            "step": 230000,
            "examples_count": 1840000,
            "loss_train": -0.7090199325203895,
            "loss_test": 0.035325266676396135,
            "metrics_train": {
                "losses/distances": 0.0,
                "losses/transformation": 0.0,
                "losses/material": 0.0,
                "losses/light": 0.0,
                "losses/denoiser": -7090.199325203896
            },
            "metrics_test": {
                "losses/distances": 0.0,
                "losses/transformation": 0.0,
                "losses/material": 0.0,
                "losses/light": 0.0,
                "losses/denoiser": 0.035325266676396135
            },
            "created": "20240706001220",
            "state_path": "f8dcc5adb74d4cd7461ab97b1a814bba/snapshots/000230000_20240706001220.pth"
        },
        "240000": {
            "epoch": 24,
            "step": 240000,
            "examples_count": 1920000,
            "loss_train": -0.70934558852911,
            "loss_test": 0.034961670461297036,
            "metrics_train": {
                "losses/distances": 0.0,
                "losses/transformation": 0.0,
                "losses/material": 0.0,
                "losses/light": 0.0,
                "losses/denoiser": -7093.4558852911
            },
            "metrics_test": {
                "losses/distances": 0.0,
                "losses/transformation": 0.0,
                "losses/material": 0.0,
                "losses/light": 0.0,
                "losses/denoiser": 0.034961670461297036
            },
            "created": "20240706043039",
            "state_path": "f8dcc5adb74d4cd7461ab97b1a814bba/snapshots/000240000_20240706043039.pth"
        },
        "250000": {
            "epoch": 25,
            "step": 250000,
            "examples_count": 2000000,
            "loss_train": -0.7097769377827644,
            "loss_test": 0.03520439000874758,
            "metrics_train": {
                "losses/distances": 0.0,
                "losses/transformation": 0.0,
                "losses/material": 0.0,
                "losses/light": 0.0,
                "losses/denoiser": -7097.769377827644
            },
            "metrics_test": {
                "losses/distances": 0.0,
                "losses/transformation": 0.0,
                "losses/material": 0.0,
                "losses/light": 0.0,
                "losses/denoiser": 0.03520439000874758
            },
            "created": "20240706085005",
            "state_path": "f8dcc5adb74d4cd7461ab97b1a814bba/snapshots/000250000_20240706085005.pth"
        },
        "260000": {
            "epoch": 26,
            "step": 260000,
            "examples_count": 2080000,
            "loss_train": -0.7103038660466671,
            "loss_test": 0.03389262084439397,
            "metrics_train": {
                "losses/distances": 0.0,
                "losses/transformation": 0.0,
                "losses/material": 0.0,
                "losses/light": 0.0,
                "losses/denoiser": -7103.038660466671
            },
            "metrics_test": {
                "losses/distances": 0.0,
                "losses/transformation": 0.0,
                "losses/material": 0.0,
                "losses/light": 0.0,
                "losses/denoiser": 0.03389262084439397
            },
            "created": "20240706125807",
            "state_path": "f8dcc5adb74d4cd7461ab97b1a814bba/snapshots/000260000_20240706125807.pth"
        }
    }
}
